import numpy as np
import copy
import random

multSigmoid = 0.01

def m_sum(m):
    val=0
    for i in range(0, len(m)):
        val+=m[i]
    return val


def m_sub(m1, m2):
    if(len(m1)==len(m2)):
        tempArray=[]
        for i in range(0, len(m1)):
            tempArray.append(m1[i]-m2[i])
        return tempArray

def m_pow(m1, m2):
    tempArray=[]
    for i in range(0, len(m1)):
        tempArray.append(pow(m1[i], m2))
    return tempArray


def sigmoid(z):
    return 1.0/(1+np.exp(-multSigmoid*z))

def sigmoidArray(z):
    tempVar = []
    for i in range(0, len(z)):
        tempVar.append(sigmoid(z[i]))
    return tempVar

def inverseSigmoid(z):
    if z != 1:
        return (1.0/multSigmoid)*np.ln(z/(1-z))
    return "DNE"

def getMaxIndex(array):
    k = 0
    max = array[k]

    for i in range(0, len(array)):
        if array[i] > max:
            max = array[i]
            k = i

    return k

def getMax(array):
    k = 0
    max = array[k]

    for i in range(0, len(array)):
        if array[i] > max:
            max = array[i]
            k = i

    return max

training = [
    # [[5, 10], 20],
    # [[6, 12], 24],
    # [[9, 18], 36]
]

for i in range(0, 100):
    training.append([])
    var = np.random.randint(20)

    for j in range(0, 2):
        if (j%2) == 0:
            training[i].append([sigmoid(var), sigmoid(2*var)])
        else:
            training[i].append(sigmoid(4*var))

values = []
answer = []

for i in range(0, len(training)):
    for j in range(0, len(training[i])):
        if (j % 2) == 0:
            values.append(training[i][j])
        else:
            answer.append(training[i][j])

class Neural_Network():

    def __init__(self, layers):
        self.layers = layers
        self.wb = [] #weights and biases
        self.best = [] #best weights and biases

        # for i in range(0, self.layers.__len__()-1):
        #     self.wb.append([])
        #     for j in range(0, self.layers[i+1]):
        #         self.wb[i].append([])
        #         for k in range(0, self.layers[i]+1):
        #             self.wb[i][j].append(random.random())

        self.wb = [[[-73.15773888299624, -237.14457222603588, 3.218037425791234, -229.18229567335544, 225.0597622658502, 46.546885819703704, -70.86345969068557, 15.061144998442673, -94.60338624975189, -45.65876745769016, 7.920140565281125, -57.39788803838947, -79.37491421477819, -183.23457900086697, -72.00563045590138, 135.51956730219732, 69.6267938167738, 69.10234878795679, -69.42354922194264, -115.01628009614801, -111.52265095713653, 33.34432224523128, 135.0207382211363, -66.29837509832144, 57.742382212980296, 78.46452979507954, -273.05164596758596, -134.8382825182919, 77.01959593709078, -58.0508272622706, -34.8456331549087, -2.752890315139478, -92.99555620742703, 116.28941652023508, 55.494735411673254, -98.55473101337515, 149.2656434752958, -166.8337426409165, -115.30369563524862, 66.07581743676685, -104.63748734536382, -261.99872756340403, 106.01407371212782, 30.125456664036083, -17.5926868078764, 116.41258921158348, -60.72735281663245, -60.88637845682493, 88.91700229536318, -39.84012271973371, -104.91546019482684, -106.68028938478628, 62.60051212785071, 87.47136972410982, -0.37880654269501335, 68.96902891230462, 44.38572526623946, 72.88847070611448, -163.30827472764764, 153.44285231173734, -21.858626351696955, -181.5034351988224, 30.789745299635303, -131.47206901920376, -29.259393751068007, -308.83849603218357, 200.45095795888136, -36.59261772575605, -206.11112777234692, -79.64102286973025, -239.6144922982344, 69.30079031046326, 45.54245576988753, 114.96684478991622, 330.3355875025974, -227.10133596845506, 17.46633552498591, 139.17487233223127, 179.5551318730315, -113.10132790790237, -95.84386063446262, 86.63857528584127, -93.79278302631724, 105.36235680115149, 84.77882878418721, 124.25708370813831, 82.41571756603703, 102.45418781370049, -25.556479721617453, 80.87073112193323, -174.20065218494273, -15.921627689720687, 44.92439684626458, -0.5758964961922466, 41.928694308858724, 231.6147468903068, -90.96187090666783, 160.39338395039584, 9.610617637044575, 14.58094566325145, -7.1973771675979314, 58.213266838342555, -3.7404283186446854, 234.003265056058, 1.0844036551629692, -151.97794171984702, 1.4705204803269005, -138.14663481829086, -110.9794801264659, 150.01722033331583, 90.80309314215474, -181.57486805789824, 42.5792943027605, 10.504144561867989, 110.00588472051257, 75.32394320601212, 311.80563001297065, 7.929339677512991, -109.96335363485784, -292.17768960279096, 26.84330265730535, 143.3272668077337, 7.40695155334301, 296.31041978513656, -98.53957200488988, 66.9694731575584, -103.09170808347153, -58.860736915266465, 9.82459589773405, 168.76486992243468, -166.11741002892182, 110.10834940711791, 58.58091392967668, 51.81597410979665, 13.134296840701182, 165.95655162176556, -250.69392723218047, -230.94119556010645, -35.723101318377815, -162.86988417364466, 127.19060674114989, -87.99940926532597, 49.84445763009628, 182.58810864639617, 220.31780694454366, -27.488828750965517, -230.68839383430551, -92.90024055284486, -1.3334451956592392, -25.240125747349275, 234.48803831441475, 4.605967195683371, 37.465030031068835, -58.59037445852914, -216.18598522637842, -9.726669035816782, -176.66030679399896, -9.275372457182334, 71.42165879287674, 26.741667234439745, -34.12397274871849, 141.35834234039413, 228.47156709798097, -146.1957816336684, 35.51294932900594, 104.8230515497333, -2.091938286695319, -3.2043899806233824, 27.875140467234583, -43.460800038024324, -6.100735801480056, 186.3190073737829, 9.189123766492141, 157.7585336460459, 20.646650628735884, 0.6697488956161557, -69.03451091965138, 43.95207332014645, -46.4001918302392, -42.48419399174319, -5.748890540705007, -83.44648336317013, -49.92699108824844, 70.36572215466437, -31.762184392936245, -100.36922090101841, 28.31843078756691, 44.56747209330812, 304.19421066944176, -141.90581937293723, 93.42677832085474, -19.77843930189378, 8.205508714255323, 27.606188621026337, 179.12190907705224, 83.96875279742207, 103.09321378887103, 270.8768485917425, 136.55921482052986, -127.56934739298106, 101.12799560872757, 77.10046061181835, 50.611042180916755, -119.53618093885447, -4.834146112500786, -155.01010370175004, -34.61757162249263, -196.84757748398505, -45.5494503311968, -216.65951963872266, 202.12188404224662, -194.64252751130343, 178.70360283717403, 83.30276581503215, 135.74302445082694, -69.29109202894085, 242.2722085115111, 254.40042793339555, 117.97840385076398, -0.9266379300766587, -129.85367590797102, 75.15445509335845, 16.240939547185246, -153.55121452343943, 44.60784619045481, 79.6298140324367, 47.992261149984586, 184.95833817128033, 193.87041320511517, -59.08644078666181, 107.18858363832436, -100.7251282611759, 4.338309648484658, -41.78342264260412, -52.84963775299569, -71.24830275063553, -142.7594051780759, 28.86086624410017, -265.6714664217629, 133.32443445750275, 22.32784969784425, 54.26857163665696, 9.328878951285269, -25.37217218614332, 133.95798133277557, 118.93891113588309, -14.936168150272128, 134.92500345536175, -18.60019405846544, -185.1291730071603, -89.1989384724525, -83.42548681028079, -227.2543771623279, -17.004047165503664, -41.89934000354505, 4.303793280418551, -107.43469802293117, -148.52525642417746, 275.2896995159506, -21.281495497628853, 97.76474487681335, -145.4832603102053, -30.1508712549953, -10.358523312871728, 146.4326898118385, 115.01668937221383, 107.23236352807854, -35.6701699864128, -23.704822980043723, -66.35009427559714, -11.670606180076296, -30.5316227476055, 309.92823227059176, 85.8044759963181, 35.13113205657641, -67.41578332787941, 137.3751165008064, -44.668191319203466, -33.436441155940614, -8.421261731729976, -50.91838675823238, 122.17098587332879, -31.51295837266591, -147.44258273632502, -59.813857105865665, 93.82618210585663, 21.185311597268882, -105.60535645676028, -273.4135025923226, -82.43009085962065, -9.596387611253002, 57.08181191748254, -25.356153483767397, 185.59002287235998, 95.02743338842252, -104.736795569425, 73.84962214965802, 117.94993908325922, -109.73840855090855, 96.01869816108508, 0.07832412767024677], [-86.3637826902342, 143.95633562959273, 129.8549839790302, 49.846140467378966, 129.4499034106656, 15.320902112784992, -68.69602060239387, 97.35154134502804, 48.69791064248839, 96.54041277609439, 44.314629924376746, -55.796457783281376, -169.4953325962574, -22.642633669196293, -81.92385637342633, 116.37708960461838, -107.47518625192937, -20.11117807689264, -192.431506512665, -186.1155333489195, 111.4046388355845, -117.88541778664656, 67.03041404268366, -44.82428116453225, 46.476645229282354, 62.3183782880851, -11.933842813190978, -134.84886634582557, -56.946858637030246, -286.46020225789056, 6.209559279535066, 62.02982732494248, 183.89475944046242, 69.89285033851775, -69.038794599865, -25.7808374106352, -128.70162231079067, 93.43922400037742, 9.409970601787673, 43.22044077681017, 56.878730752097574, 92.16523075628409, -153.83916238502195, -102.0738861463089, -9.061508642098369, 71.12404804226718, -81.91046462648038, 124.04042833552946, -77.1852499631931, 53.45975259935604, -15.450798098692811, 99.63805778453482, 230.73088217311178, 153.74582157609188, 191.51649398810477, -88.09971757863761, -79.99200062693302, -60.39302838290902, 8.152066210674636, -97.84891570628449, 44.99497719128614, -66.79076431651694, -16.110148188070454, 112.17906406014305, 22.465593332774468, 11.074805858438296, -50.43459488793151, 64.0191340922865, 123.72460724138539, 53.32419316465351, 74.63977586244124, 161.52521399868385, -3.3291452424231847, -123.33036467888878, -42.5782941935007, 44.12847060534151, -58.25371582209665, 102.64834855772652, -77.95362143937373, 74.50409093569206, -42.06426916970003, 86.05129700182825, 268.8886688824561, -120.90455622692096, 191.93180887703969, -153.38249868357136, -45.554358077237296, 75.16055070913109, 32.554048959658644, -240.10899760247995, 86.5250413505924, -6.5204590607525255, -45.226962332114375, 71.69117506948366, -147.76664718735813, 249.5042795817098, -20.941749950164414, -73.1564837109322, 118.46180935798674, 172.4052300000269, 113.94887079614291, -39.56378736543405, 16.873844081558907, 76.6655408740034, 57.263341961663606, -227.38188493641854, -28.202090627782503, -18.081286663583647, -57.48625051782615, 57.03531671593839, -209.64648487705426, 140.1270440892669, -64.03216951996255, 148.93023012331506, -42.96806562744756, 83.85345337274636, -155.85430323098097, 212.1419418963145, -52.86997328625807, 20.44240856809582, 58.875533583709576, -149.49172120827535, 165.14848271576406, -84.5059412723208, -116.98194238200665, -62.39658201578538, -194.82378096745845, 41.5102420844298, 89.57887905744778, 190.3291415630998, -15.928070202830472, 81.82937660705143, -45.014957317938354, -43.035408188775406, -141.9467358343122, 88.43132898092331, 108.43957116915936, 0.6048284255543592, -3.0239172815594655, 131.9397609282123, 163.2161169605357, -22.844110093977605, -213.26540514512237, -34.32203174342092, -59.610195430014045, -69.49784730223425, -44.39519244559759, -302.41125837938006, -123.51821945117615, 24.125217352529152, 130.2493876416048, 23.18850093302334, -139.69136541813774, -176.0077716672299, 86.96657984043439, -109.51681408522386, -64.69728835928673, 48.11468866757657, -100.42440209502342, 164.62712214435481, 144.17423789985926, -148.69674354024957, -28.241935280970004, -11.191378334723577, 87.92931465666112, 30.23431769240746, 26.442279556327406, 4.595911395254108, 47.06104542423822, 18.938268796997882, -109.35508794619116, 93.76303120863874, 207.1910675643748, 234.22919271595717, -39.01500878031388, 129.22413377609016, -23.765441711603266, 8.078593958181463, 90.18568296597351, 28.14888597600674, -142.75324946230475, 100.88682195778118, 32.40496143879573, 36.94245135974064, 112.91856435725447, 206.82317064200294, 70.31613065364414, 104.1258454461772, -84.11550173693614, -221.6736560089699, -67.49756291606593, 21.870206990187043, 103.33450775628002, -73.73044067493991, -120.83279847849232, -32.33892375034465, -87.22242074306718, -97.69068902272038, -127.59370417605972, -54.7238203194387, -65.05138351784196, -22.291137523751082, 142.04574838868118, 78.50954800714445, 196.2096851996425, 128.86284342241237, 108.16989444487905, -206.51275019255274, 45.04905053831176, 0.20164629213414642, 62.45764888224775, 157.74289201018482, -245.7944956119461, -101.96215672717976, -47.07918833715034, -22.88184526665414, 146.18839684845528, 132.06629306261763, -20.23776920341006, 91.06173304399478, 175.3454912578799, 35.976385225912956, 131.69260975629476, 20.629578999741838, -61.009365374379115, -95.35274466353488, -22.649426544474395, -80.80324820240317, -90.20764687288239, -144.626274700715, -75.56479501950746, -132.11205902478514, 105.18740636588673, 135.69559055353588, -142.89661179492091, -49.52580384552084, 12.822018966735643, 26.892144747542197, 16.235805547454525, -52.4548218147037, 292.19565959150333, 176.80077293584262, 23.16664030817168, 72.5900318111529, -193.7954071706074, -82.31388771472844, 162.00297322195925, 22.667899134226847, -90.45168247929999, 149.26454009811772, 86.21636413773352, 29.190711619282798, 57.52262817495376, -167.31385541038065, 23.462064155971305, -46.37244947685695, -7.675349751403316, 105.13483240457381, -76.66594259597811, -92.46238561604522, -5.378579820959658, 100.22544646838342, -76.89767556778033, -80.63600956832376, 10.110745449130892, -168.7913055810626, 23.990984125402086, 27.95650189802639, 58.15801550859172, -214.305625972989, -135.80206312675415, -7.200846869342403, 19.529778285961157, -1.3761820887929677, 259.601183618435, 17.745900661882654, -211.28969410820042, -61.062896349053645, -157.24941205005052, -43.393746184292155, 171.2190653400585, -108.8896629651714, 73.17685268102773, 150.17559028290114, -119.40436991606492, 91.49827629623525, -125.56458530508925, -18.90780431906094, -76.37540738022501, 109.77548885620318, 15.822997383062468, -4.852245970103866, -84.43530960791074, -91.32523079382229, -53.79672815896006, -27.984560339360037, 20.715443755469952, 26.69980275626215, -58.022650028701634, 46.8517366388332, 0.9695258314208095], [20.47598962100252, 28.585269359624984, 180.63166032748026, -39.67405145737956, 39.25739127692114, 53.962591708451676, -148.6202551471651, 56.40575707398587, -243.5794212800166, 32.70676082438007, -98.96346636530046, 42.05518326045144, 96.01352982131124, -49.58138690961348, -291.4544612323722, -22.484485817983597, -104.77986133001738, 115.73945010774295, 112.4982851941914, 158.01427712567343, 75.34374446864095, -32.942295776771694, 89.55732712563756, -9.631905362430158, 88.45511706370102, -151.95631324091744, -188.14819431217896, -74.50828632953387, -62.68002231628378, 131.241619974421, 305.5339326159536, 132.64900788690946, -124.39433425301347, -90.10791050159155, -140.77824169537303, 129.45812743052994, 177.29062569775397, -22.076071389619266, 5.843131312810666, -68.53097139208508, 100.22403901656722, 17.4111063544896, 220.52136179956034, -83.26830656782059, 140.38836616569944, -5.418531728918115, -116.603671636301, 18.528793604171227, -116.65886881474546, -84.71553431981849, -11.520916116883852, -93.60389360503802, 219.57336733410148, 7.51048605932732, 179.37778411202433, 32.088119527482846, 173.8006304643785, 121.68895584284125, -172.4646012417094, -6.756298465570964, -26.66959828029615, -41.68937964135228, -116.18021857031228, -235.15999282416564, 91.81179240746334, 11.085507432692449, -168.08846597316722, 71.5105050486178, -156.71901527283347, -35.569443413416124, 202.6612971326118, 31.443795006791408, -61.810611374786575, 157.19717298620446, -70.19150357403215, 156.5463873353923, 116.44767054633752, 94.45496362349128, 159.61449239007288, -30.285303084309113, -120.9102816340626, -20.227456375276514, -141.12562776793922, -52.201771210549694, -123.70947271921294, 181.01765451500071, -218.493938393157, 110.34148910750976, -147.22408430774394, -15.149023269304891, -235.23993768198653, 34.081399867390076, 227.84900850108824, 109.28429270050894, 14.539563275868066, -80.4968173283786, 77.24893920831282, 67.66252262698274, -77.70160068217746, 68.14022405510975, 300.92014362345935, 94.76951286757466, -116.47601526331403, -42.62424369717468, 93.2012384261959, 54.551432210658675, -211.11375594682045, -5.3326803038635315, 169.06281340399562, 71.82396442276386, -5.541023694632164, 217.0171213637267, -43.914410036977415, 65.08799258299821, -62.87999572091481, 70.84445750441203, 127.68983082290202, -125.41457758326118, -4.24429869325907, -43.77308887761018, -86.13387837105674, -5.228842186671969, 44.57319409249506, -78.81646140491844, -94.92212506344451, -51.38420541927738, -94.93816726539926, 9.513509751201873, -200.82267390683037, 58.050171188222286, 187.09721870412974, 16.920337115560308, -302.87672882089726, 54.242179013489306, 225.65891224709642, -52.39987869055773, -95.59625408019608, 5.605777600189114, 11.46509433155865, -14.910512497715114, -68.57706729059329, 3.9812110976931, 3.3468952156618466, 75.28751419551342, 34.47040027283718, -57.73751007599297, -119.28831849045189, 246.8096075230087, -313.63138053707905, -27.544796858249754, 54.01891540758823, 145.2951225196383, -129.80627946030427, 86.0768033979866, -201.12670596328857, 163.32505723211202, -193.0027122900866, 17.547917891425634, -127.8551146329169, 185.9778728601414, 85.79105274760735, 97.1747092178751, -70.39950674695919, -199.34304118676383, -62.30087973945206, -23.79241403593531, -71.7913456248902, -68.60796771549445, -141.9533209140185, 135.6367210879255, -2.4449319449800146, -3.509721141633568, 146.01773440170345, -158.83783110555498, 12.024335652854262, 114.64882189580955, 69.18430469564115, 95.84237618152656, -120.18065370232259, -81.00723065638861, -95.84591547474851, 17.008789054592157, 19.316255362323997, -35.12031206911356, -104.41779209480899, 94.2470126467434, 60.96748565320712, -34.86756369438616, -70.53630485527894, 40.86917113521184, -151.69866619517475, 106.71237895464168, 65.59393099396547, 86.29978391403517, -183.36147847416106, -45.19825684519712, 131.3656535446495, -104.87785957859414, -160.10610151094895, -120.0734587539183, 51.117831277121994, 90.26515706583609, -152.3420768790917, 49.97047490299191, -44.51585335912945, -35.55137190239158, -10.566630516438652, 108.18170506711786, -29.19984557315376, -47.93134789057689, 36.4310420781114, -53.70107670460531, -63.36039606451596, 98.2227868023113, 202.80357226229347, -128.17049217747442, 56.42984308844637, 81.43275776868207, 71.3691909709006, 70.77688934307162, 15.794385135998915, 180.35802684499288, 4.23181425736425, 146.96221638821817, 207.82664425573793, -56.95226222139155, 34.28949250998192, 4.566636626619303, 129.64225679257277, -69.46650240012202, 25.231014177530085, 78.34303966476902, 38.80708750834346, -153.13993101896475, 48.09181714013352, 122.05373532618265, 39.05035604521606, -67.7099116081386, -131.55438183001147, 137.87703224593196, -97.0995598832291, 120.59097533728438, 240.87055059085228, 46.244694741794845, -2.543212914085693, 113.70536076286147, 92.12328309568252, 26.018188126930117, 191.29088288179406, 57.485683900442886, 15.017064390653234, 151.9709916105776, 25.612303730491604, 35.67259973167575, -74.01483816448433, 6.7374471942654495, 22.7851569249488, 24.05102705440033, 12.783512983571026, -5.502464460601205, 63.92980400757782, 15.95533312885747, -3.127029504054935, 119.25769520722392, -34.89167804195995, -243.3757842678407, -100.07881022585902, 29.08305879591181, -134.86096401050546, -35.005000701659924, -35.43194509354577, -99.33597297946676, -41.36282969208802, 18.095291975578547, 138.6493709469008, 165.4177100516534, -80.93722363536072, -19.404388349791432, -123.53361008772393, 32.531750054988564, 361.8742299250005, 129.84093749256513, -36.683985111956986, -77.16071782474629, -106.87363294788364, -27.486511372109106, 12.424696605916854, -39.94519305254223, 139.51325462558054, -102.37032887714007, 68.46176628825685, 9.017875572194704, -53.224404816845166, 98.03327364349815, -112.7416607224685, 52.05980533708825, 81.76276995362541, 129.8276495141752, 83.37049089005545, 105.94216943536738, 0.459406759281368], [81.38128438454727, -8.92129711053203, -111.00338401593027, 104.09959579630353, -66.01345862529523, -71.78382747172567, -293.33990469820804, 54.84289271134548, -38.2224333232879, 8.288335666653824, -131.72941924036343, 2.9526381086101345, 98.43935084177679, -63.5408251775837, 156.4247811087737, -33.68587187516775, 73.44830779302481, 75.14370315594397, 14.896722765087398, -14.673060205307305, -180.44243508837437, -10.690253178225891, -36.662974194965706, 14.892011564349389, 67.30744278160442, 141.11045230531346, 60.997938090686674, -126.95336363317433, -39.71631740158764, -224.46590020483984, -156.10971130926407, 152.3926319209306, -115.16353253057437, 16.654175603899706, 181.60417217518267, -228.247171868938, -64.16509793852634, -55.342075326321016, 215.1850651378333, -74.15394933692878, -147.65446194627148, -46.329372021653086, 194.90057184202826, -66.60970805891496, -62.137218001213284, 135.7868915841885, -140.4422058782192, -178.83339182131442, 48.50601371130115, -86.3736111217707, 274.98533102804817, 112.35307822965636, -204.26329533789178, 51.63220799487378, -109.35259976414248, 127.23085933686326, -12.57794183342062, 45.49181661149222, -411.94361224073026, -34.91873689824881, 49.699816904511124, -181.40238921422537, 61.65671719253807, 84.04904922756276, -29.863431327728875, 30.711051208175995, -20.12506973270215, -41.69645822049247, -68.95004714222976, -77.04358842000607, -10.524555506907511, -193.74729613174844, -68.4886239363082, -108.31764755072341, -109.19581265774347, -44.32849534743229, -172.8684278710803, 213.2863049937745, -25.245380046152363, 16.070872307235263, -9.765453468291945, 57.14328964551906, 63.100257145434135, 30.365540053904187, 28.6595639740057, -128.12401255024648, -28.766177496731736, -46.64212208328011, -332.225001091005, 59.84132008655894, 62.91501805341572, 94.5855302177994, -12.36947855519696, -12.131365573121446, -15.057417818521706, 40.109616831135135, 81.06662461113663, 17.9766366372409, 119.95647386229052, 50.16451276580536, -70.97317082177038, -126.01880787235667, 95.26945094346242, 29.85905391168466, -174.1407578365397, 123.04152981967948, -202.44977843062048, 26.633216961594357, 21.83889284700689, -215.51143350673763, -116.82194853594206, -6.638614512817554, 161.530982623598, -213.98514488487615, 126.43931647814472, -80.44280194268228, 41.48543083224055, 16.46451401672079, 112.72003903748609, -125.99150625057834, -146.0172780140218, -45.6408258617125, -143.0542192658875, -81.9196028168281, -36.59709271119852, 49.59802609859609, -86.13426393687043, -37.07657979151961, -172.03505802716788, -122.60002326029151, 21.22688459820713, 109.04009783742329, -184.05042656409984, 33.079218184562656, -125.63123081130357, 24.90914131217928, 40.29185349229157, 67.84668726222813, 211.4804975005813, 19.711922157535717, 107.33152509367463, 184.80326129775958, -192.02731453650856, -10.300637696407247, -56.40430906902213, 64.63087822776495, -77.20044234021074, -156.00582499602635, -24.166471673673648, 227.66984885870872, -5.941495587641377, -105.67475446617853, -54.141854006556194, 73.6586803191326, -53.47430544266153, -123.04405144953913, -58.33118453684198, 180.35366354021292, -98.5633316471589, -139.63985386577303, 7.399766589973351, -42.22205669038907, 161.52569438334606, 22.230236327345956, -31.15505008641066, -25.30008488457382, -109.6410893449583, -212.31549544472495, -2.40188490434147, 268.822915505893, -184.88942622968645, 158.4244176717333, 101.11373576803646, -22.104447670749884, -124.64081886986462, -151.879185929335, 42.11737108428223, -115.8113617923042, -102.7109463518974, 78.35123091729109, -30.643357225424673, 8.313230148814693, 115.13801713475428, 279.9266514255032, 71.9546013477068, -16.448918786371475, 86.08616476678395, -50.38871013223786, -144.95767057331446, -50.299106906422644, 59.428088579469005, -38.42024015890581, 38.651819646887716, -83.39746009218361, -50.98202983973981, 94.920741109051, -109.93724251653933, -87.85346288594391, 103.57658465111126, 131.309683588314, 62.43331641181591, 145.21703714405672, 63.58811476557969, 128.005155907961, -113.92469409928796, -67.51961222305354, 210.3357478316961, -78.78981074073833, 132.0676921710574, -45.135392164523545, -96.8988595706336, 24.50185393670099, 2.7423543398952486, 138.1302583169137, 79.58862670677539, 18.863941572982803, 80.6377181286101, 8.575394367913209, -73.2551766718379, 20.80859362676997, 7.090371684852249, 102.97588172812696, 84.29093248452514, 94.10503408139184, -23.038262105322914, 114.65079984358864, 125.40397853324956, -12.473831196211467, 83.39141275890307, 254.65792867314454, -11.046478597767145, 88.05638400891614, -151.2354572132959, -84.62611339152868, -26.677960047113793, 181.60761189183853, -136.98595637407306, -36.53032311667966, -114.8975931526941, -18.802427350962343, 149.2222199368691, -19.207173905205845, 294.82794625622734, -26.25375038882168, -6.729619050163371, -152.42410149260724, 134.30130496155851, -70.61333536969687, -15.544788391703943, 62.12147064425403, 122.75603433691167, 110.49915497209054, -28.458650918483727, 113.81604595452497, -45.38701834033116, -42.34422924639658, -40.27710678838939, -96.00727460410523, 66.80943133978235, -73.71331985542199, 23.53694962290342, -175.06249957730876, 247.06640037981145, -21.70391271287968, 14.076641568185394, 99.63581761412283, -89.84426347302016, 178.50028183767373, -222.84455287856292, 33.179549898769686, -22.714751832551414, 22.578138398264954, 7.730857620924276, -3.14488160503565, -45.963121448884806, 62.6419509796023, 76.07494258898923, -2.9382822726095235, -136.71187020839915, -126.02659449111543, 117.45178361808522, 145.6494143679735, 115.57567057772907, 53.376998896014655, -321.7266380746044, 234.58589250915492, -80.60501199116106, -75.99183234761526, -138.61185572172872, -25.13400520239993, 15.629585505042048, -208.44355767392662, 66.45165219899845, -11.058558176524938, 62.02342240670616, -145.29156564197854, 240.85943577637173, -120.52445942411029, 86.9091611650671, 94.8250539563511, 0.930048256255736]]]


        # text = open("wb.txt", 'r')
        # data = text.readline(1)

        self.best = self.wb

    def func(self, input):
        neurons = []

        for i in range(0, len(self.layers)):
            neurons.append([])
            for j in range (0, self.layers[i]):
                neurons[i].append(0)

        neurons[0] = input

        for i in range(0, len(self.layers)-1): #previous layer
            for j in range(0, self.layers[i+1]): #current neuron
                tempVar = 0
                for k in range(0, self.layers[i]): #previous layer's neurons
                    tempVar += neurons[i][k] * self.wb[i][j][k]
                    tempVar += self.wb[i][j][k+1]
                neurons[i+1][j] = sigmoid(tempVar)
        return neurons[len(self.layers)-1]

    def getAnswer(self, input):
        return getMaxIndex(self.func(input))

    def getCost(self, val, answer):
        return m_sum(m_pow(m_sub(self.func(val), [answer]), 2))

    def bestWB(self):
        self.best = copy.deepcopy(self.wb)

    def neat(self, alpha):
        for i in range(0, len(self.layers) - 1):  # previous layer
            for j in range(0, self.layers[i + 1]):  # current neuron
                for k in range(0, self.layers[i]):  # previous layer's neurons
                    self.wb[i][j][k] = self.best[i][j][k] + alpha * (random.random()-0.5)